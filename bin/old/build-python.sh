#!/bin/bash
. "`dirname -- "$0"`"/functions.sh || exit

version="$1"
if [ "$version" == "" ]; then
  version=$(curl http://python.org/ftp/python/|egrep -o '[0-9]+\.[0-9]+\.[0-9]+'|sort -t. -k1,1n -k2,2n -k3,3n|tail -n1)
fi

# install pythonz
curl -kL https://raw.github.com/saghul/pythonz/master/pythonz-install | bash

# install python
. "$HOME/.pythonz/etc/bashrc"
pythonz install "$version"

# create startup script
( echo "# generated by $DOTFILES_DIR/bin/$(basename -- "$0")"
  echo 'if [[ -s "$HOME/.pythonz/etc/bashrc" ]]; then'
  echo '  . "$HOME/.pythonz/etc/bashrc"'
  echo "  export PATH=\"\$HOME/.pythonz/pythons/CPython-$version/bin:\$PATH\""
  echo 'fi'
) | make_profile_script "10-python.sh"
load_profile_script "10-python.sh"

# install easy_install
cd_tmpdir && curl http://python-distribute.org/distribute_setup.py | python

# install pip
easy_install pip
