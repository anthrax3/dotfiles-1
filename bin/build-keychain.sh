#!/bin/bash
. "`dirname -- "$0"`"/functions.sh || exit

src="$DOTFILES_DIR/env/src/keychain"
dest="$DOTFILES_DIR/env/dest/keychain"

# get sources
if [ ! -d "$src/.git" ]; then
  git clone git://github.com/funtoo/keychain.git "$src" || exit 1
fi
cd "$src" || exit 1
git pull

# install
make || exit 1
mkdir -p "$dest/bin"
mkdir -p "$dest/man/man1"
cp -ap "$src/keychain" "$dest/bin/"
cp -ap "$src/keychain.1" "$dest/man/man1/"

# create startup script
( echo "# generated by $DOTFILES_DIR/bin/$(basename -- "$0")"
  echo "export PATH=\"$dest/bin:\$PATH\""
) | make_profile_script 10-keychain.sh
