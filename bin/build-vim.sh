#!/bin/bash
. "`dirname -- "$0"`"/functions.sh || exit

src="$DOTFILES_SRC/vim"
dest="$DOTFILES_DEST/vim"

# 必要パッケージのチェック
has_rpm_packages mercurial libselinux-devel || exit 1
mkdir -p "$src"
hg clone "https://vim.googlecode.com/hg/" "$src"

# get sources
cd "$src" || exit 1
hg pull
hg update
./configure --prefix="$dest" --enable-multibyte --enable-pythoninterp --with-features=big && make && make install || exit 1

# create startup script
( echo "# generated by $DOTFILES_DIR/bin/$(basename -- "$0")"
  echo "export PATH="$dest/bin:\$PATH""
) | make_profile_script 10-vim.sh
